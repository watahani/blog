<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="FIDO 2.0 対応のキー届いた。 Security Key by Yubico という名前らしい。">
<meta property="og:type" content="article">
<meta property="og:title" content="FIDO2 対応の Security Key ファーストインプレッション">
<meta property="og:url" content="http://blog.haniyama.com/2018/04/26/fido2-security-key/index.html">
<meta property="og:site_name" content="enjoy struggling">
<meta property="og:description" content="FIDO 2.0 対応のキー届いた。 Security Key by Yubico という名前らしい。">
<meta property="og:locale">
<meta property="og:image" content="http://blog.haniyama.com/2018/04/26/fido2-security-key/keys.jpg">
<meta property="og:image" content="http://blog.haniyama.com/2018/04/26/fido2-security-key/webauthn1.png">
<meta property="og:image" content="http://blog.haniyama.com/2018/04/26/fido2-security-key/webauthn2.png">
<meta property="article:published_time" content="2018-04-26T13:07:11.000Z">
<meta property="article:modified_time" content="2022-05-18T13:45:29.057Z">
<meta property="article:author" content="watahani">
<meta property="article:tag" content="YubiKey">
<meta property="article:tag" content="FIDO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.haniyama.com/2018/04/26/fido2-security-key/keys.jpg">
<meta name="twitter:creator" content="@watahani"><meta name="description"><meta name="keywords" content="Java, Javascript, AWS, GCP, PGP"><link rel="alternate" type="application/atom+xml" href="/atom.xml" title="enjoy struggling"><title>FIDO2 対応の Security Key ファーストインプレッション - enjoy struggling</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.png"><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-113476970-1', 'auto');ga('send', 'pageview');</script><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-atom-dark.css" type="text/css"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a target="_blank" rel="noopener" href="https://github.com/watahani"><span>Github</span></a></li><li><a target="_blank" rel="noopener" href="https://qiita.com/watahani"><span>Qiita</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><link rel="amphtml" href="./amp/index.html"><label class="navi-button light" for="navi">MENU</label><img class="background" src="https://storage.googleapis.com/blog-haniyama/background-min.png"><div class="post-title"><h1 class="title">FIDO2 対応の Security Key ファーストインプレッション</h1><ul class="meta"><li><i class="icon icon-author"></i>watahani</li><li><i class="icon icon-clock"></i>42 Minutes</li><li><i class="icon icon-calendar"></i>April 26, 2018</li></ul></div></div><div class="article-content" style="max-width:800px"><h2 id="FIDO-2-0-対応のキー"><a href="#FIDO-2-0-対応のキー" class="headerlink" title="FIDO 2.0 対応のキー"></a>FIDO 2.0 対応のキー</h2><p>届いた。 <a target="_blank" rel="noopener" href="https://www.yubico.com/product/security-key-by-yubico/">Security Key by Yubico</a> という名前らしい。</p>
<span id="more"></span>

<blockquote class="twitter-tweet" data-lang="ja"><p lang="ja" dir="ltr">FIDO2 対応の Security Key 届いた <a target="_blank" rel="noopener" href="https://t.co/8taKRfWlrP">pic.twitter.com/8taKRfWlrP</a></p>&mdash; 82 (@watahani) <a target="_blank" rel="noopener" href="https://twitter.com/watahani/status/989460163420569600?ref_src=twsrc%5Etfw">2018年4月26日</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="FIDO-2-0-とは"><a href="#FIDO-2-0-とは" class="headerlink" title="FIDO 2.0 とは"></a>FIDO 2.0 とは</h2><p>FIDO U2F および UAF を拡張した認証標準で、まあ要は <a target="_blank" rel="noopener" href="https://www.w3.org/TR/webauthn/">WebAuthn</a> と <a target="_blank" rel="noopener" href="https://fidoalliance.org/specs/fido-v2.0-rd-20161004/fido-client-to-authenticator-protocol-v2.0-rd-20161004.html">CTAP</a> のこと。</p>
<p>さっと中身をナナメ読みすると、 FIDO U2F の sign する ClientData にもっといろいろ突っ込めるようにしたような規格（まだちゃんと読んでない…）<br>通信容量削減のため CBOR とかいうバイト配列のデータに、RPやチャレンジ以外のデータも色々突っ込んで <del>Token Binding やら IDの代わりにしたりできるっぽい。</del></p>
<p>また PIN や biometrics 要求を Authenticator に投げられるようになってることにより、 U2F が2段階認証だったのが、FIDO2 だと <strong>PIN + デバイス</strong> だったり、<strong>指紋 + デバイス</strong> だったりで本当の意味でパスワードフリーになっている。</p>
<p>このあたりの話については、もう少しきちんとスペックを理解してから纏めようと思うが、今日はファーストインプレッションということで。</p>
<h2 id="見た感じ"><a href="#見た感じ" class="headerlink" title="見た感じ"></a>見た感じ</h2><p><img src="/2018/04/26/fido2-security-key/keys.jpg"></p>
<p>左から、YubiKey4、Security Key by Yubico, Security Key(U2Fのみ対応のもの)</p>
<p>厚さも重さもほぼ変わらず。<br>旧 Security Key とはキーチェーンの穴がプラか金属部分が出ているかと、謎の “2” の刻印以外はおぼ同じ。</p>
<p>ただし、古いキーも最近のロットはキーチェーンに金属が入っているので、実質　“2” の刻印以外は見た目は変わらない。<br>爪でこするぐらいじゃ消え無さそうだった(笑) さすがにレーザー刻印なのかな？</p>
<h2 id="とりあえず使ってみる-WebAuthn"><a href="#とりあえず使ってみる-WebAuthn" class="headerlink" title="とりあえず使ってみる (WebAuthn)"></a>とりあえず使ってみる (WebAuthn)</h2><p>とりあえず触ってみる。</p>
<p>まずは、Yubico のサンプルサーバー と Firefox Nightly で WebAuthn のテスト</p>
<blockquote>
<p>WebAuthn のデモは <a target="_blank" rel="noopener" href="https://webauthn.io/">ここ</a> とか <a target="_blank" rel="noopener" href="http://webauthn.bin.coffee/">ここ</a> とかでも</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Yubico/python-fido2/tree/master/examples/server">https://github.com/Yubico/python-fido2/tree/master/examples/server</a></p>
<pre class="language-bash" style="" tabindex="0"><code id="4e38193f" class="language-bash" data-prism-hydrate="{&quot;element&quot;:&quot;4e38193f&quot;,&quot;language&quot;:&quot;bash&quot;,&quot;code&quot;:&quot;\n\u003e git clone https://github.com/Yubico/python-fido2.git\n> cd .\\python-fido2\\server\\\n> python -m venv .venv\n> .\\.venv\\Scripts\\Activate.ps1\n> pip install -r requirement.txt\n> python server.py\nExample demo server to use a supported web browser to call the WebAuthn APIs\nto register and use a credential.\n\nTo run (using a virtualenv is recommended):\n  $ pip install -r requirements.txt\n  $ python server.py\n\nNow navigate to https://localhost:5000 in a supported web browser.\n\n * Restarting with stat\n\nExample demo server to use a supported web browser to call the WebAuthn APIs\nto register and use a credential.\n\nTo run (using a virtualenv is recommended):\n  $ pip install -r requirements.txt\n  $ python server.py\n\nNow navigate to https://localhost:5000 in a supported web browser.\n\n * Debugger is active!\n * Debugger PIN: 605-258-233\n * Running on https://127.0.0.1:5000/ (Press CTRL+C to quit)\n&quot;,&quot;highlightedCode&quot;:&quot;\n\u003cspan class=\&quot;token operator\&quot;>></span> <span class=\&quot;token function\&quot;>git</span> clone https://github.com/Yubico/python-fido2.git\n<span class=\&quot;token operator\&quot;>></span> <span class=\&quot;token builtin class-name\&quot;>cd</span> .<span class=\&quot;token punctuation\&quot;>\\</span>python-fido2<span class=\&quot;token punctuation\&quot;>\\</span>server<span class=\&quot;token punctuation\&quot;>\\</span>\n<span class=\&quot;token operator\&quot;>></span> python <span class=\&quot;token parameter variable\&quot;>-m</span> venv .venv\n<span class=\&quot;token operator\&quot;>></span> .<span class=\&quot;token punctuation\&quot;>\\</span>.venv<span class=\&quot;token punctuation\&quot;>\\</span>Scripts<span class=\&quot;token punctuation\&quot;>\\</span>Activate.ps1\n<span class=\&quot;token operator\&quot;>></span> pip <span class=\&quot;token function\&quot;>install</span> <span class=\&quot;token parameter variable\&quot;>-r</span> requirement.txt\n<span class=\&quot;token operator\&quot;>></span> python server.py\nExample demo server to use a supported web browser to call the WebAuthn APIs\nto register and use a credential.\n\nTo run <span class=\&quot;token punctuation\&quot;>(</span>using a virtualenv is recommended<span class=\&quot;token punctuation\&quot;>)</span>:\n  $ pip <span class=\&quot;token function\&quot;>install</span> <span class=\&quot;token parameter variable\&quot;>-r</span> requirements.txt\n  $ python server.py\n\nNow navigate to https://localhost:5000 <span class=\&quot;token keyword\&quot;>in</span> a supported web browser.\n\n * Restarting with <span class=\&quot;token function\&quot;>stat</span>\n\nExample demo server to use a supported web browser to call the WebAuthn APIs\nto register and use a credential.\n\nTo run <span class=\&quot;token punctuation\&quot;>(</span>using a virtualenv is recommended<span class=\&quot;token punctuation\&quot;>)</span>:\n  $ pip <span class=\&quot;token function\&quot;>install</span> <span class=\&quot;token parameter variable\&quot;>-r</span> requirements.txt\n  $ python server.py\n\nNow navigate to https://localhost:5000 <span class=\&quot;token keyword\&quot;>in</span> a supported web browser.\n\n * Debugger is active<span class=\&quot;token operator\&quot;>!</span>\n * Debugger PIN: <span class=\&quot;token number\&quot;>605</span>-258-233\n * Running on https://127.0.0.1:5000/ <span class=\&quot;token punctuation\&quot;>(</span>Press CTRL+C to quit<span class=\&quot;token punctuation\&quot;>)</span>\n&quot;}">
<span class="token operator">&gt;</span> <span class="token function">git</span> clone https://github.com/Yubico/python-fido2.git
<span class="token operator">&gt;</span> <span class="token builtin class-name">cd</span> .<span class="token punctuation">\</span>python-fido2<span class="token punctuation">\</span>server<span class="token punctuation">\</span>
<span class="token operator">&gt;</span> python <span class="token parameter variable">-m</span> venv .venv
<span class="token operator">&gt;</span> .<span class="token punctuation">\</span>.venv<span class="token punctuation">\</span>Scripts<span class="token punctuation">\</span>Activate.ps1
<span class="token operator">&gt;</span> pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirement.txt
<span class="token operator">&gt;</span> python server.py
Example demo server to use a supported web browser to call the WebAuthn APIs
to register and use a credential.

To run <span class="token punctuation">(</span>using a virtualenv is recommended<span class="token punctuation">)</span>:
  $ pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
  $ python server.py

Now navigate to https://localhost:5000 <span class="token keyword">in</span> a supported web browser.

 * Restarting with <span class="token function">stat</span>

Example demo server to use a supported web browser to call the WebAuthn APIs
to register and use a credential.

To run <span class="token punctuation">(</span>using a virtualenv is recommended<span class="token punctuation">)</span>:
  $ pip <span class="token function">install</span> <span class="token parameter variable">-r</span> requirements.txt
  $ python server.py

Now navigate to https://localhost:5000 <span class="token keyword">in</span> a supported web browser.

 * Debugger is active<span class="token operator">!</span>
 * Debugger PIN: <span class="token number">605</span>-258-233
 * Running on https://127.0.0.1:5000/ <span class="token punctuation">(</span>Press CTRL+C to quit<span class="token punctuation">)</span>
</code></pre>

<p>アクセスして register を押すと</p>
<p><img src="/2018/04/26/fido2-security-key/webauthn1.png"></p>
<p>WebAuthn のダイアログが出て…</p>
<p><img src="/2018/04/26/fido2-security-key/webauthn2.png"></p>
<p>Keyにタッチするとサーバーログに認証データが出てくる。</p>
<pre class="language-py" style="" tabindex="0"><code id="a459563f" class="language-py" data-prism-hydrate="{&quot;element&quot;:&quot;a459563f&quot;,&quot;language&quot;:&quot;py&quot;,&quot;code&quot;:&quot;\nclientData {\&quot;challenge\&quot;:\&quot;szm47zk9-ueHSO1IRhGzHI1BgHYp27uueGB7mF2Z2cg\&quot;,\&quot;clientExtensions\&quot;:{},\&quot;hashAlgorithm\&quot;:\&quot;SHA-256\&quot;,\&quot;origin\&quot;:\&quot;https://localhost:5000\&quot;,\&quot;type\&quot;:\&quot;webauthn.create\&quot;}\nAttestationObject: AttestationObject(fmt: \u0027fido-u2f', auth_data: AuthenticatorData(rp_id_hash: h'49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763', flags: 0x41, counter: 0, credential_data: AttestedCredentialData(aaguid: h'00000000000000000000000000000000', credential_id: h'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e', public_key: {1: 2, 3: -7, -1: 1, -2: b'\\xc0\\x83\\xe0Z\\xd4t\\xfd\\tr\\xc5\\xb7\\xe5g\\xe3\\x0cd\\x81\\x82{\\xf7\\xe6\\xa8*\\x92\\x83\\x89\\xb0\\xf7a\\xfc@\\x15', -3: b'\\x1e\\x18[\\xb2T\\x17@7\\xdf\\x1f\\x9c\\xd5\\x07\\xb5+Egg$;\\x179\\xbdB\\xe3\\xed\\x84\\x7fT\\xad\\xf6\\xb4'}), att_statement: {'sig': b'0E\\x02!\\x00\\x8c\\xb2x\\xa5\\x8d\\x99\\xebJ\\x10\\xd2\\xde\\xd7\\xaa@\\xd9\\x1e2S\\xb1\\xab\\x03\\xedt\\x00\\xe2\\xe5g\\x0fy\\xbcN\\xde\\x02 S\\x1d\\xe9\\xdb\\x084\\x1e\\x0c\\x17\\x88\\xb6\\xc4uA\\xf0\\xcfD\\x14\\xf2U\\x8e\\x9c\\xf0!\\x03\\x1c\\xea\\xab\\xcf\\xe6\\x9aH', 'x5c': [b'0\\x82\\x02\\xbe0\\x82\\x01\\xa6\\xa0\\x03\\x02\\x01\\x02\\x02\\x04t\\x86\\xfd\\xc20\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x000.1,0*\\x06\\x03U\\x04\\x03\\x13#Yubico U2F Root CA Serial 4572006310 \\x17\\r140801000000Z\\x18\\x0f20500904000000Z0o1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02SE1\\x120\\x10\\x06\\x03U\\x04\\n\\x0c\\tYubico AB1\&quot;0 \\x06\\x03U\\x04\\x0b\\x0c\\x19Authenticator Attestation1(0\u0026\\x06\\x03U\\x04\\x03\\x0c\\x1fYubico U2F EE Serial 19550038420Y0\\x13\\x06\\x07*\\x86H\\xce=\\x02\\x01\\x06\\x08*\\x86H\\xce=\\x03\\x01\\x07\\x03B\\x00\\x04\\x95]\\xf3\\xad\\xf7$}1u\\xef\\xfd\\x9c\\xc4\\xf3\\x1aN\\x87\\x8e\\xba\\xe1\\x81\\tVaP\\xfb8\\x8b._e\\'\\xbfW@\\x9a\\xa5\\x81\\xa5\\r\\n\\xc5/\\x18D\\\\\\n\\x13T\\x8a\\x13S\\xc8\\xa4\\xe5\\x9apNR;\\xc0M\\xeb\\xed\\xa3l0j0\&quot;\\x06\\t+\\x06\\x01\\x04\\x01\\x82\\xc4\\n\\x02\\x04\\x151.3.6.1.4.1.41482.1.10\\x13\\x06\\x0b+\\x06\\x01\\x04\\x01\\x82\\xe5\\x1c\\x02\\x01\\x01\\x04\\x04\\x03\\x02\\x05 0!\\x06\\x0b+\\x06\\x01\\x04\\x01\\x82\\xe5\\x1c\\x01\\x01\\x04\\x04\\x12\\x04\\x10\\xf8\\xa0\\x11\\xf3\\x8c\\nM\\x15\\x80\\x06\\x17\\x11\\x1f\\x9e\\xdc}0\\x0c\\x06\\x03U\\x1d\\x13\\x01\\x01\\xff\\x04\\x020\\x000\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x00\\x03\\x82\\x01\\x01\\x001\\\\H\\x80\\xe6\\x9aR~8f\\x89\\xbdi\\xfd\\n\\xa8oI\\xeb\\x9eN\\x85EAUo\\xaa\\xd0\\x0b:\\x00\\x8a\\x1d\\xdc\\x01\\xf9lv\\xf6h6\\x1a\\x91\\xe22\\xc8\\x10\\xa7\\x9cc\\x07L\\x9bnzF\\xeb\\x1d\\xb5\\xd8\\\\DH\\x9f\\x86\\x8avC\\xd2*\\\\\\x86.\\xc0?\\x03\\xe5\\x84\\x8b\\xe3\\x80}z\\xcdU\\xf8\\xe1\\xae\\x1e\\xe2\\x13\\xacs\\xabK \\xe3\\xfb\\xd5&amp;\\x8c\\xb0{\\x87\\x80\\'\\x1d\\x1fK\\xe0\\xe5\\xdd\\xacsM:X\\x97\\xbdMs\\xba\\x7f5~\\xa2\\x08\\xc9\\x9d\\x8aM)\\x02\\xe6\\tz\\x00\\\\M\\xc9\\x04\\xdc\\n\\x18\\x12\\x0e\\n\\xf7\\xd0\\x0c\\xfc\\x96\\x9a(\\x86\\xe5\\xb1\\xb1a\\xf3\\xed\\xcb\\xc6w\\xa6x\\xd7\\xfbS\\x03\\x9c\\xcd\\xa1\\x86\\xbe4\\xbaS1\\x95#C\\x9d\\x7f\\xd9Jp\\xf20b\\x1b\\x93\\xc4\\xceBh\\xd3\\x17M\\x94;\\xc6\\xae?\\xc97\\xc2\\xdeC\\xd6\\xb4N!\\x15=\\xf8P\\x92_\\x95\\x90b.\\xbcF\\xe0\\xeb\\x18\\xc6A\\xf0\\xfe~o*\\t\\xa9\\xb2\\x90w\\x19\\xf6.a5\\xa1\\x902\\xa2\\x13\\xc0\\x98\\xb7(\u003c\\xee']})\nREGISTERED CREDENTIAL: AttestedCredentialData(aaguid: h'00000000000000000000000000000000', credential_id: h'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e', public_key: {1: 2, 3: -7, -1: 1, -2: b'\\xc0\\x83\\xe0Z\\xd4t\\xfd\\tr\\xc5\\xb7\\xe5g\\xe3\\x0cd\\x81\\x82{\\xf7\\xe6\\xa8*\\x92\\x83\\x89\\xb0\\xf7a\\xfc@\\x15', -3: b'\\x1e\\x18[\\xb2T\\x17@7\\xdf\\x1f\\x9c\\xd5\\x07\\xb5+Egg$;\\x179\\xbdB\\xe3\\xed\\x84\\x7fT\\xad\\xf6\\xb4'}\n&quot;,&quot;highlightedCode&quot;:&quot;\nclientData <span class=\&quot;token punctuation\&quot;\u003e{</span><span class=\&quot;token string\&quot;>\&quot;challenge\&quot;</span><span class=\&quot;token punctuation\&quot;>:</span><span class=\&quot;token string\&quot;>\&quot;szm47zk9-ueHSO1IRhGzHI1BgHYp27uueGB7mF2Z2cg\&quot;</span><span class=\&quot;token punctuation\&quot;>,</span><span class=\&quot;token string\&quot;>\&quot;clientExtensions\&quot;</span><span class=\&quot;token punctuation\&quot;>:</span><span class=\&quot;token punctuation\&quot;>{</span><span class=\&quot;token punctuation\&quot;>}</span><span class=\&quot;token punctuation\&quot;>,</span><span class=\&quot;token string\&quot;>\&quot;hashAlgorithm\&quot;</span><span class=\&quot;token punctuation\&quot;>:</span><span class=\&quot;token string\&quot;>\&quot;SHA-256\&quot;</span><span class=\&quot;token punctuation\&quot;>,</span><span class=\&quot;token string\&quot;>\&quot;origin\&quot;</span><span class=\&quot;token punctuation\&quot;>:</span><span class=\&quot;token string\&quot;>\&quot;https://localhost:5000\&quot;</span><span class=\&quot;token punctuation\&quot;>,</span><span class=\&quot;token string\&quot;>\&quot;type\&quot;</span><span class=\&quot;token punctuation\&quot;>:</span><span class=\&quot;token string\&quot;>\&quot;webauthn.create\&quot;</span><span class=\&quot;token punctuation\&quot;>}</span>\nAttestationObject<span class=\&quot;token punctuation\&quot;>:</span> AttestationObject<span class=\&quot;token punctuation\&quot;>(</span>fmt<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>'fido-u2f'</span><span class=\&quot;token punctuation\&quot;>,</span> auth_data<span class=\&quot;token punctuation\&quot;>:</span> AuthenticatorData<span class=\&quot;token punctuation\&quot;>(</span>rp_id_hash<span class=\&quot;token punctuation\&quot;>:</span> h<span class=\&quot;token string\&quot;>'49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763'</span><span class=\&quot;token punctuation\&quot;>,</span> flags<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>0x41</span><span class=\&quot;token punctuation\&quot;>,</span> counter<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>0</span><span class=\&quot;token punctuation\&quot;>,</span> credential_data<span class=\&quot;token punctuation\&quot;>:</span> AttestedCredentialData<span class=\&quot;token punctuation\&quot;>(</span>aaguid<span class=\&quot;token punctuation\&quot;>:</span> h<span class=\&quot;token string\&quot;>'00000000000000000000000000000000'</span><span class=\&quot;token punctuation\&quot;>,</span> credential_id<span class=\&quot;token punctuation\&quot;>:</span> h<span class=\&quot;token string\&quot;>'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e'</span><span class=\&quot;token punctuation\&quot;>,</span> public_key<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token punctuation\&quot;>{</span><span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>2</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token number\&quot;>3</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>7</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>2</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>b'\\xc0\\x83\\xe0Z\\xd4t\\xfd\\tr\\xc5\\xb7\\xe5g\\xe3\\x0cd\\x81\\x82{\\xf7\\xe6\\xa8*\\x92\\x83\\x89\\xb0\\xf7a\\xfc@\\x15'</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>3</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>b'\\x1e\\x18[\\xb2T\\x17@7\\xdf\\x1f\\x9c\\xd5\\x07\\xb5+Egg$;\\x179\\xbdB\\xe3\\xed\\x84\\x7fT\\xad\\xf6\\xb4'</span><span class=\&quot;token punctuation\&quot;>}</span><span class=\&quot;token punctuation\&quot;>)</span><span class=\&quot;token punctuation\&quot;>,</span> att_statement<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token punctuation\&quot;>{</span><span class=\&quot;token string\&quot;>'sig'</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>b'0E\\x02!\\x00\\x8c\\xb2x\\xa5\\x8d\\x99\\xebJ\\x10\\xd2\\xde\\xd7\\xaa@\\xd9\\x1e2S\\xb1\\xab\\x03\\xedt\\x00\\xe2\\xe5g\\x0fy\\xbcN\\xde\\x02 S\\x1d\\xe9\\xdb\\x084\\x1e\\x0c\\x17\\x88\\xb6\\xc4uA\\xf0\\xcfD\\x14\\xf2U\\x8e\\x9c\\xf0!\\x03\\x1c\\xea\\xab\\xcf\\xe6\\x9aH'</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token string\&quot;>'x5c'</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token punctuation\&quot;>[</span><span class=\&quot;token string\&quot;>b'0\\x82\\x02\\xbe0\\x82\\x01\\xa6\\xa0\\x03\\x02\\x01\\x02\\x02\\x04t\\x86\\xfd\\xc20\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x000.1,0*\\x06\\x03U\\x04\\x03\\x13#Yubico U2F Root CA Serial 4572006310 \\x17\\r140801000000Z\\x18\\x0f20500904000000Z0o1\\x0b0\\t\\x06\\x03U\\x04\\x06\\x13\\x02SE1\\x120\\x10\\x06\\x03U\\x04\\n\\x0c\\tYubico AB1\&quot;0 \\x06\\x03U\\x04\\x0b\\x0c\\x19Authenticator Attestation1(0&amp;amp;\\x06\\x03U\\x04\\x03\\x0c\\x1fYubico U2F EE Serial 19550038420Y0\\x13\\x06\\x07*\\x86H\\xce=\\x02\\x01\\x06\\x08*\\x86H\\xce=\\x03\\x01\\x07\\x03B\\x00\\x04\\x95]\\xf3\\xad\\xf7$}1u\\xef\\xfd\\x9c\\xc4\\xf3\\x1aN\\x87\\x8e\\xba\\xe1\\x81\\tVaP\\xfb8\\x8b._e\\'\\xbfW@\\x9a\\xa5\\x81\\xa5\\r\\n\\xc5/\\x18D\\\\\\n\\x13T\\x8a\\x13S\\xc8\\xa4\\xe5\\x9apNR;\\xc0M\\xeb\\xed\\xa3l0j0\&quot;\\x06\\t+\\x06\\x01\\x04\\x01\\x82\\xc4\\n\\x02\\x04\\x151.3.6.1.4.1.41482.1.10\\x13\\x06\\x0b+\\x06\\x01\\x04\\x01\\x82\\xe5\\x1c\\x02\\x01\\x01\\x04\\x04\\x03\\x02\\x05 0!\\x06\\x0b+\\x06\\x01\\x04\\x01\\x82\\xe5\\x1c\\x01\\x01\\x04\\x04\\x12\\x04\\x10\\xf8\\xa0\\x11\\xf3\\x8c\\nM\\x15\\x80\\x06\\x17\\x11\\x1f\\x9e\\xdc}0\\x0c\\x06\\x03U\\x1d\\x13\\x01\\x01\\xff\\x04\\x020\\x000\\r\\x06\\t*\\x86H\\x86\\xf7\\r\\x01\\x01\\x0b\\x05\\x00\\x03\\x82\\x01\\x01\\x001\\\\H\\x80\\xe6\\x9aR~8f\\x89\\xbdi\\xfd\\n\\xa8oI\\xeb\\x9eN\\x85EAUo\\xaa\\xd0\\x0b:\\x00\\x8a\\x1d\\xdc\\x01\\xf9lv\\xf6h6\\x1a\\x91\\xe22\\xc8\\x10\\xa7\\x9cc\\x07L\\x9bnzF\\xeb\\x1d\\xb5\\xd8\\\\DH\\x9f\\x86\\x8avC\\xd2*\\\\\\x86.\\xc0?\\x03\\xe5\\x84\\x8b\\xe3\\x80}z\\xcdU\\xf8\\xe1\\xae\\x1e\\xe2\\x13\\xacs\\xabK \\xe3\\xfb\\xd5&amp;amp;\\x8c\\xb0{\\x87\\x80\\'\\x1d\\x1fK\\xe0\\xe5\\xdd\\xacsM:X\\x97\\xbdMs\\xba\\x7f5~\\xa2\\x08\\xc9\\x9d\\x8aM)\\x02\\xe6\\tz\\x00\\\\M\\xc9\\x04\\xdc\\n\\x18\\x12\\x0e\\n\\xf7\\xd0\\x0c\\xfc\\x96\\x9a(\\x86\\xe5\\xb1\\xb1a\\xf3\\xed\\xcb\\xc6w\\xa6x\\xd7\\xfbS\\x03\\x9c\\xcd\\xa1\\x86\\xbe4\\xbaS1\\x95#C\\x9d\\x7f\\xd9Jp\\xf20b\\x1b\\x93\\xc4\\xceBh\\xd3\\x17M\\x94;\\xc6\\xae?\\xc97\\xc2\\xdeC\\xd6\\xb4N!\\x15=\\xf8P\\x92_\\x95\\x90b.\\xbcF\\xe0\\xeb\\x18\\xc6A\\xf0\\xfe~o*\\t\\xa9\\xb2\\x90w\\x19\\xf6.a5\\xa1\\x902\\xa2\\x13\\xc0\\x98\\xb7(&amp;lt;\\xee'</span><span class=\&quot;token punctuation\&quot;>]</span><span class=\&quot;token punctuation\&quot;>}</span><span class=\&quot;token punctuation\&quot;>)</span>\nREGISTERED CREDENTIAL<span class=\&quot;token punctuation\&quot;>:</span> AttestedCredentialData<span class=\&quot;token punctuation\&quot;>(</span>aaguid<span class=\&quot;token punctuation\&quot;>:</span> h<span class=\&quot;token string\&quot;>'00000000000000000000000000000000'</span><span class=\&quot;token punctuation\&quot;>,</span> credential_id<span class=\&quot;token punctuation\&quot;>:</span> h<span class=\&quot;token string\&quot;>'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e'</span><span class=\&quot;token punctuation\&quot;>,</span> public_key<span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token punctuation\&quot;>{</span><span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>2</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token number\&quot;>3</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>7</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>2</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>b'\\xc0\\x83\\xe0Z\\xd4t\\xfd\\tr\\xc5\\xb7\\xe5g\\xe3\\x0cd\\x81\\x82{\\xf7\\xe6\\xa8*\\x92\\x83\\x89\\xb0\\xf7a\\xfc@\\x15'</span><span class=\&quot;token punctuation\&quot;>,</span> <span class=\&quot;token operator\&quot;>-</span><span class=\&quot;token number\&quot;>3</span><span class=\&quot;token punctuation\&quot;>:</span> <span class=\&quot;token string\&quot;>b'\\x1e\\x18[\\xb2T\\x17@7\\xdf\\x1f\\x9c\\xd5\\x07\\xb5+Egg$;\\x179\\xbdB\\xe3\\xed\\x84\\x7fT\\xad\\xf6\\xb4'</span><span class=\&quot;token punctuation\&quot;>}</span>\n&quot;}">
clientData <span class="token punctuation">{</span><span class="token string">"challenge"</span><span class="token punctuation">:</span><span class="token string">"szm47zk9-ueHSO1IRhGzHI1BgHYp27uueGB7mF2Z2cg"</span><span class="token punctuation">,</span><span class="token string">"clientExtensions"</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"hashAlgorithm"</span><span class="token punctuation">:</span><span class="token string">"SHA-256"</span><span class="token punctuation">,</span><span class="token string">"origin"</span><span class="token punctuation">:</span><span class="token string">"https://localhost:5000"</span><span class="token punctuation">,</span><span class="token string">"type"</span><span class="token punctuation">:</span><span class="token string">"webauthn.create"</span><span class="token punctuation">}</span>
AttestationObject<span class="token punctuation">:</span> AttestationObject<span class="token punctuation">(</span>fmt<span class="token punctuation">:</span> <span class="token string">'fido-u2f'</span><span class="token punctuation">,</span> auth_data<span class="token punctuation">:</span> AuthenticatorData<span class="token punctuation">(</span>rp_id_hash<span class="token punctuation">:</span> h<span class="token string">'49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763'</span><span class="token punctuation">,</span> flags<span class="token punctuation">:</span> <span class="token number">0x41</span><span class="token punctuation">,</span> counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> credential_data<span class="token punctuation">:</span> AttestedCredentialData<span class="token punctuation">(</span>aaguid<span class="token punctuation">:</span> h<span class="token string">'00000000000000000000000000000000'</span><span class="token punctuation">,</span> credential_id<span class="token punctuation">:</span> h<span class="token string">'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e'</span><span class="token punctuation">,</span> public_key<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">b'\xc0\x83\xe0Z\xd4t\xfd\tr\xc5\xb7\xe5g\xe3\x0cd\x81\x82{\xf7\xe6\xa8*\x92\x83\x89\xb0\xf7a\xfc@\x15'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">b'\x1e\x18[\xb2T\x17@7\xdf\x1f\x9c\xd5\x07\xb5+Egg$;\x179\xbdB\xe3\xed\x84\x7fT\xad\xf6\xb4'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> att_statement<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'sig'</span><span class="token punctuation">:</span> <span class="token string">b'0E\x02!\x00\x8c\xb2x\xa5\x8d\x99\xebJ\x10\xd2\xde\xd7\xaa@\xd9\x1e2S\xb1\xab\x03\xedt\x00\xe2\xe5g\x0fy\xbcN\xde\x02 S\x1d\xe9\xdb\x084\x1e\x0c\x17\x88\xb6\xc4uA\xf0\xcfD\x14\xf2U\x8e\x9c\xf0!\x03\x1c\xea\xab\xcf\xe6\x9aH'</span><span class="token punctuation">,</span> <span class="token string">'x5c'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">b'0\x82\x02\xbe0\x82\x01\xa6\xa0\x03\x02\x01\x02\x02\x04t\x86\xfd\xc20\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x000.1,0*\x06\x03U\x04\x03\x13#Yubico U2F Root CA Serial 4572006310 \x17\r140801000000Z\x18\x0f20500904000000Z0o1\x0b0\t\x06\x03U\x04\x06\x13\x02SE1\x120\x10\x06\x03U\x04\n\x0c\tYubico AB1"0 \x06\x03U\x04\x0b\x0c\x19Authenticator Attestation1(0&amp;\x06\x03U\x04\x03\x0c\x1fYubico U2F EE Serial 19550038420Y0\x13\x06\x07*\x86H\xce=\x02\x01\x06\x08*\x86H\xce=\x03\x01\x07\x03B\x00\x04\x95]\xf3\xad\xf7$}1u\xef\xfd\x9c\xc4\xf3\x1aN\x87\x8e\xba\xe1\x81\tVaP\xfb8\x8b._e\'\xbfW@\x9a\xa5\x81\xa5\r\n\xc5/\x18D\\\n\x13T\x8a\x13S\xc8\xa4\xe5\x9apNR;\xc0M\xeb\xed\xa3l0j0"\x06\t+\x06\x01\x04\x01\x82\xc4\n\x02\x04\x151.3.6.1.4.1.41482.1.10\x13\x06\x0b+\x06\x01\x04\x01\x82\xe5\x1c\x02\x01\x01\x04\x04\x03\x02\x05 0!\x06\x0b+\x06\x01\x04\x01\x82\xe5\x1c\x01\x01\x04\x04\x12\x04\x10\xf8\xa0\x11\xf3\x8c\nM\x15\x80\x06\x17\x11\x1f\x9e\xdc}0\x0c\x06\x03U\x1d\x13\x01\x01\xff\x04\x020\x000\r\x06\t*\x86H\x86\xf7\r\x01\x01\x0b\x05\x00\x03\x82\x01\x01\x001\\H\x80\xe6\x9aR~8f\x89\xbdi\xfd\n\xa8oI\xeb\x9eN\x85EAUo\xaa\xd0\x0b:\x00\x8a\x1d\xdc\x01\xf9lv\xf6h6\x1a\x91\xe22\xc8\x10\xa7\x9cc\x07L\x9bnzF\xeb\x1d\xb5\xd8\\DH\x9f\x86\x8avC\xd2*\\\x86.\xc0?\x03\xe5\x84\x8b\xe3\x80}z\xcdU\xf8\xe1\xae\x1e\xe2\x13\xacs\xabK \xe3\xfb\xd5&amp;\x8c\xb0{\x87\x80\'\x1d\x1fK\xe0\xe5\xdd\xacsM:X\x97\xbdMs\xba\x7f5~\xa2\x08\xc9\x9d\x8aM)\x02\xe6\tz\x00\\M\xc9\x04\xdc\n\x18\x12\x0e\n\xf7\xd0\x0c\xfc\x96\x9a(\x86\xe5\xb1\xb1a\xf3\xed\xcb\xc6w\xa6x\xd7\xfbS\x03\x9c\xcd\xa1\x86\xbe4\xbaS1\x95#C\x9d\x7f\xd9Jp\xf20b\x1b\x93\xc4\xceBh\xd3\x17M\x94;\xc6\xae?\xc97\xc2\xdeC\xd6\xb4N!\x15=\xf8P\x92_\x95\x90b.\xbcF\xe0\xeb\x18\xc6A\xf0\xfe~o*\t\xa9\xb2\x90w\x19\xf6.a5\xa1\x902\xa2\x13\xc0\x98\xb7(&lt;\xee'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
REGISTERED CREDENTIAL<span class="token punctuation">:</span> AttestedCredentialData<span class="token punctuation">(</span>aaguid<span class="token punctuation">:</span> h<span class="token string">'00000000000000000000000000000000'</span><span class="token punctuation">,</span> credential_id<span class="token punctuation">:</span> h<span class="token string">'f9c62b17c868223f619223f7f705be4b29b314b7b237073389319d922cc61ce5d913b1ec68a9da6917cb362ce9ed0623d4d5f0a3d4b7b21db661b2628b6d7e0e'</span><span class="token punctuation">,</span> public_key<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">b'\xc0\x83\xe0Z\xd4t\xfd\tr\xc5\xb7\xe5g\xe3\x0cd\x81\x82{\xf7\xe6\xa8*\x92\x83\x89\xb0\xf7a\xfc@\x15'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">b'\x1e\x18[\xb2T\x17@7\xdf\x1f\x9c\xd5\x07\xb5+Egg$;\x179\xbdB\xe3\xed\x84\x7fT\xad\xf6\xb4'</span><span class="token punctuation">}</span>
</code></pre>

<p>ふむふむ… あれ？</p>
<p>aaguid が空だし、fmtが…</p>
<p><code>fmt: &#39;fido-u2f&#39;</code> </p>
<h4>ってまだ U2F でしか動かないんかーい！</h4>

<p>ブラウザの実装の問題なのか、サーバーのAPI呼び出し方法の問題なのか、よくわかんない。</p>
<p>多分前者？</p>
<h2 id="とりあえず使ってみる-CTAP"><a href="#とりあえず使ってみる-CTAP" class="headerlink" title="とりあえず使ってみる (CTAP)"></a>とりあえず使ってみる (CTAP)</h2><p>せっかく届いたので寝る前に FIDO2 らしいことをしたい。なので、同じく Yubico の python製の FIDO Client を試してみる。<br>examples ディレクトリ直下の get_info.py を叩くと、 CTAP で規定されたキーで利用できる認証方法のデータが返ってくる。</p>
<pre class="language-bash" style="" tabindex="0"><code id="29a4cf3c" class="language-bash" data-prism-hydrate="{&quot;element&quot;:&quot;29a4cf3c&quot;,&quot;language&quot;:&quot;bash&quot;,&quot;code&quot;:&quot;\n\u003e  python .\\get_info.py\nCONNECT: CtapHidDevice(b\u0027\\\\\\\\?\\\\hid#vid_1050\u0026pid_0120#7&amp;1a9dc5a8&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\\x00')\nDEVICE INFO: Info(versions: ['U2F_V2', 'FIDO_2_0'], extensions: ['hmac-secret'], aaguid: h'f8a011f38c0a4d15800617111f9edc7d', options: {'rk': True, 'up': True, 'plat': False, 'clientPin': False}, max_message_size: 1200, pin_protocols: [1])\nWINK sent!\n&quot;,&quot;highlightedCode&quot;:&quot;\n\u003cspan class=\&quot;token operator\&quot;>></span>  python .<span class=\&quot;token punctuation\&quot;>\\</span>get_info.py\nCONNECT: CtapHidDevice<span class=\&quot;token punctuation\&quot;>(</span>b<span class=\&quot;token string\&quot;>'\\\\\\\\?\\\\hid#vid_1050&amp;amp;pid_0120#7&amp;amp;1a9dc5a8&amp;amp;0&amp;amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\\x00'</span><span class=\&quot;token punctuation\&quot;>)</span>\nDEVICE INFO: Info<span class=\&quot;token punctuation\&quot;>(</span>versions: <span class=\&quot;token punctuation\&quot;>[</span><span class=\&quot;token string\&quot;>'U2F_V2'</span>, <span class=\&quot;token string\&quot;>'FIDO_2_0'</span><span class=\&quot;token punctuation\&quot;>]</span>, extensions: <span class=\&quot;token punctuation\&quot;>[</span><span class=\&quot;token string\&quot;>'hmac-secret'</span><span class=\&quot;token punctuation\&quot;>]</span>, aaguid: h<span class=\&quot;token string\&quot;>'f8a011f38c0a4d15800617111f9edc7d'</span>, options: <span class=\&quot;token punctuation\&quot;>{</span><span class=\&quot;token string\&quot;>'rk'</span><span class=\&quot;token builtin class-name\&quot;>:</span> True, <span class=\&quot;token string\&quot;>'up'</span><span class=\&quot;token builtin class-name\&quot;>:</span> True, <span class=\&quot;token string\&quot;>'plat'</span><span class=\&quot;token builtin class-name\&quot;>:</span> False, <span class=\&quot;token string\&quot;>'clientPin'</span><span class=\&quot;token builtin class-name\&quot;>:</span> False<span class=\&quot;token punctuation\&quot;>}</span>, max_message_size: <span class=\&quot;token number\&quot;>1200</span>, pin_protocols: <span class=\&quot;token punctuation\&quot;>[</span><span class=\&quot;token number\&quot;>1</span><span class=\&quot;token punctuation\&quot;>]</span><span class=\&quot;token punctuation\&quot;>)</span>\nWINK sent<span class=\&quot;token operator\&quot;>!</span>\n&quot;}">
<span class="token operator">&gt;</span>  python .<span class="token punctuation">\</span>get_info.py
CONNECT: CtapHidDevice<span class="token punctuation">(</span>b<span class="token string">'\\\\?\\hid#vid_1050&amp;pid_0120#7&amp;1a9dc5a8&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\x00'</span><span class="token punctuation">)</span>
DEVICE INFO: Info<span class="token punctuation">(</span>versions: <span class="token punctuation">[</span><span class="token string">'U2F_V2'</span>, <span class="token string">'FIDO_2_0'</span><span class="token punctuation">]</span>, extensions: <span class="token punctuation">[</span><span class="token string">'hmac-secret'</span><span class="token punctuation">]</span>, aaguid: h<span class="token string">'f8a011f38c0a4d15800617111f9edc7d'</span>, options: <span class="token punctuation">{</span><span class="token string">'rk'</span><span class="token builtin class-name">:</span> True, <span class="token string">'up'</span><span class="token builtin class-name">:</span> True, <span class="token string">'plat'</span><span class="token builtin class-name">:</span> False, <span class="token string">'clientPin'</span><span class="token builtin class-name">:</span> False<span class="token punctuation">}</span>, max_message_size: <span class="token number">1200</span>, pin_protocols: <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
WINK sent<span class="token operator">!</span>
</code></pre>

<p>このキーは <code>U2F_V2</code> と <code>FIDO_2_0</code> に対応していて、 オプションとして、 以下が使えることがわかる。</p>
<ul>
<li><code>rk</code>: True  Resident Key キー情報を保存する領域がある</li>
<li><code>up</code>: True   User presence ユーザの存在確認が必要か、要はタッチが必要か</li>
<li><code>plat</code> : False  Platform Device か。つまり機器に埋め込まれているかどうか。TPMとか利用した Authenticator は True なのかな</li>
<li><code>ClientPin</code>: False PINが設定されているか。PIN が使えない場合、オプションが存在しない。</li>
</ul>
<p>ちなみに U2F のキーだと CBOR 送れねーぞって怒られる。</p>
<pre class="language-bash" style="" tabindex="0"><code id="631c4a3f" class="language-bash" data-prism-hydrate="{&quot;element&quot;:&quot;631c4a3f&quot;,&quot;language&quot;:&quot;bash&quot;,&quot;code&quot;:&quot;\n\u003epython .\\get_info.py\nCONNECT: CtapHidDevice(b\u0027\\\\\\\\?\\\\hid#vid_1050\u0026pid_0407&amp;mi_01#8&amp;109b7fa4&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\\x00')\nDevice does not support CBOR\nWINK sent!\n&quot;,&quot;highlightedCode&quot;:&quot;\n\u003cspan class=\&quot;token operator\&quot;>></span>python .<span class=\&quot;token punctuation\&quot;>\\</span>get_info.py\nCONNECT: CtapHidDevice<span class=\&quot;token punctuation\&quot;>(</span>b<span class=\&quot;token string\&quot;>'\\\\\\\\?\\\\hid#vid_1050&amp;amp;pid_0407&amp;amp;mi_01#8&amp;amp;109b7fa4&amp;amp;0&amp;amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\\x00'</span><span class=\&quot;token punctuation\&quot;>)</span>\nDevice does not support CBOR\nWINK sent<span class=\&quot;token operator\&quot;>!</span>\n&quot;}">
<span class="token operator">&gt;</span>python .<span class="token punctuation">\</span>get_info.py
CONNECT: CtapHidDevice<span class="token punctuation">(</span>b<span class="token string">'\\\\?\\hid#vid_1050&amp;pid_0407&amp;mi_01#8&amp;109b7fa4&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}\x00'</span><span class="token punctuation">)</span>
Device does not support CBOR
WINK sent<span class="token operator">!</span>
</code></pre>

<p>Pythonのコード追っていくと、PINの設定やPINを使った sign などもできそうだけれど、今日はここまで。</p>
<p>かえって寝ないとGWが迎えられない…。</p>
<hr>
<h3 id="2018年4月27日-追記"><a href="#2018年4月27日-追記" class="headerlink" title="2018年4月27日 追記"></a>2018年4月27日 追記</h3><p>Windows Hello のPCログインで使えるようになるらしい。<br>（ Azure AD および、個人アカウント）</p>
<p><a target="_blank" rel="noopener" href="https://cloudblogs.microsoft.com/enterprisemobility/2018/04/12/big-news-in-our-drive-to-eliminate-passwords-fido2-webauthn-reaches-candidate-recommendation-status/">Big news in our drive to eliminate passwords: FIDO2 &#x2F; WebAuthn Reaches Candidate Recommendation status! – Enterprise Mobility + Security</a></p>
<blockquote>
<p>both personal Microsoft accounts and organizational identities based on Azure Active Directory</p>
</blockquote>
<p>ただし、Insider Preview にも出ておらず、以下から申し込みをした企業向けに、試用版がとどくかもって感じらしい。</p>
<p><a target="_blank" rel="noopener" href="https://microsoft.qualtrics.com/SE/?SID=SV_brWqzOWHstHbdGd&Q_JFE=0">Online Survey | Built with Qualtrics Experience Management™</a></p>
<p>Yubico の公式動画は以下</p>
<iframe width="854" height="480" src="https://www.youtube.com/embed/wl479T2t6eo" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><div class="related-post"><h3>関連記事</h3><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\2018\06\17\edge-support-webauthn\" title="Edge が WebAuthN をサポートしたらしいので色々試してみた(Insider Preview)" rel="bookmark">Edge が WebAuthN をサポートしたらしいので色々試してみた(Insider Preview)</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\2019\07\15\azuread-fido2-security-key-public-preview\" title="Azure AD の FIDO2 Security Key 対応のパブリックプレビューが来たー" rel="bookmark">Azure AD の FIDO2 Security Key 対応のパブリックプレビューが来たー</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\2019\09\09\lost-securiykeys\" title="セキュリティキーをなくしたのでリカバリ方法を実践してみる" rel="bookmark">セキュリティキーをなくしたのでリカバリ方法を実践してみる</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\2018\09\28\ms-ignite-2018\" title="雑感 Microsoft Ignite What's new for Windows Hello for Business" rel="bookmark">雑感 Microsoft Ignite What's new for Windows Hello for Business</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\2020\10\17\serviceprincipal-certauth-using-yubikey5\" title="YubiKey 5 シリーズで Azure AD のサービス プリンシパルの証明書認証する" rel="bookmark">YubiKey 5 シリーズで Azure AD のサービス プリンシパルの証明書認証する</a></h3></div></li></ul></div></div><div class="article-meta" style="max-width:800px"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FIDO/" rel="tag">FIDO</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YubiKey/" rel="tag">YubiKey</a><span class="tag-list-count">10</span></li></ul></div></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2018/06/17/edge-support-webauthn/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2018/03/15/shiritori/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/82p" title="Github" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="https://twitter.com/watahani" title="Twitter" target="_blank"><i class="icon icon-twitter"></i></a></li><li><a href="https://www.facebook.com/haniyama.wataru" title="Facebook" target="_blank"><i class="icon icon-facebook"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2023 enjoy struggling<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>